<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦éš›çš„çŸ¥è­˜çµ±åˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  (IKIP)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.2rem;
            text-align: center;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            text-align: center;
            color: #718096;
            font-size: 1.1rem;
            font-weight: 300;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .nav-tab {
            padding: 0.7rem 1.5rem;
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e0 100%);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .nav-tab:hover::before {
            left: 100%;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(66, 153, 225, 0.4);
        }

        .nav-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .main-container {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 2.5rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            margin-top: 2rem;
            position: relative;
        }

        .tab-content.active {
            display: block;
            animation: slideInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes slideInUp {
            from { 
                opacity: 0; 
                transform: translateY(40px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        /* Dashboard Styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .dashboard-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 2rem;
            color: white;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .dashboard-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            transform: rotate(45deg);
            transition: all 0.7s;
            opacity: 0;
        }

        .dashboard-card:hover::before {
            animation: shimmer 1.5s ease-in-out;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) rotate(45deg); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(100%) rotate(45deg); opacity: 0; }
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .card-content {
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Domain-specific styles */
        .domain-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .domain-card {
            border-radius: 20px;
            padding: 2rem;
            background: white;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .domain-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
        }

        .domain-math { border-left: 5px solid #ff6b6b; }
        .domain-physics { border-left: 5px solid #4ecdc4; }
        .domain-logic { border-left: 5px solid #45b7d1; }
        .domain-creative { border-left: 5px solid #96ceb4; }
        .domain-music { border-left: 5px solid #feca57; }
        .domain-language { border-left: 5px solid #ff9ff3; }

        .domain-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .domain-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-right: 1rem;
            color: white;
        }

        .math-icon { background: linear-gradient(135deg, #ff6b6b, #ee5a6f); }
        .physics-icon { background: linear-gradient(135deg, #4ecdc4, #44a08d); }
        .logic-icon { background: linear-gradient(135deg, #45b7d1, #3867d6); }
        .creative-icon { background: linear-gradient(135deg, #96ceb4, #79b8a3); }
        .music-icon { background: linear-gradient(135deg, #feca57, #ff9ff3); }
        .language-icon { background: linear-gradient(135deg, #ff9ff3, #ff6b6b); }

        .domain-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d3748;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease-in-out;
        }

        .exercise-container {
            background: #f7fafc;
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .exercise-question {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: #2d3748;
        }

        .exercise-options {
            display: grid;
            gap: 0.5rem;
        }

        .exercise-option {
            padding: 0.8rem;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .exercise-option:hover {
            border-color: #4299e1;
            background: #ebf8ff;
        }

        .exercise-option.selected {
            border-color: #4299e1;
            background: #4299e1;
            color: white;
        }

        .exercise-option.correct {
            border-color: #48bb78;
            background: #48bb78;
            color: white;
        }

        .exercise-option.incorrect {
            border-color: #f56565;
            background: #f56565;
            color: white;
        }

        .btn {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            margin: 1rem 0.5rem 0 0;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }

        .btn-success:hover {
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.4);
        }

        .integration-map {
            width: 100%;
            height: 400px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            margin-top: 1rem;
            position: relative;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
        }

        .log-container {
            background: #1a202c;
            color: #e2e8f0;
            border-radius: 15px;
            padding: 1.5rem;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
            margin-top: 1rem;
        }

        .log-entry {
            margin-bottom: 0.5rem;
            padding: 0.3rem 0;
            border-bottom: 1px solid #2d3748;
        }

        .log-timestamp {
            color: #4299e1;
            font-weight: 600;
        }

        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #4299e1;
            display: block;
        }

        .stat-label {
            color: #718096;
            font-size: 0.9rem;
            font-weight: 500;
            margin-top: 0.5rem;
        }

        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .main-container {
                padding: 1rem;
            }
            
            .tab-content {
                padding: 1.5rem;
            }
            
            .dashboard-grid,
            .domain-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                gap: 0.5rem;
            }
            
            .nav-tab {
                padding: 0.5rem 1rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="floating-particles" id="particles"></div>
    
    <header class="header">
        <h1>å­¦éš›çš„çŸ¥è­˜çµ±åˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </h1>
        <p class="subtitle">Interdisciplinary Knowledge Integration Platform (IKIP)</p>
        
        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</button>
            <button class="nav-tab" onclick="showTab('domains')">å­¦ç¿’åˆ†é‡</button>
            <button class="nav-tab" onclick="showTab('exercises')">çµ±åˆæ¼”ç¿’</button>
            <button class="nav-tab" onclick="showTab('integration')">é–¢é€£æ€§ãƒãƒƒãƒ—</button>
            <button class="nav-tab" onclick="showTab('progress')">é€²æ—åˆ†æ</button>
            <button class="nav-tab" onclick="showTab('logs')">å­¦ç¿’ãƒ­ã‚°</button>
        </nav>
    </header>

    <main class="main-container">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <h2>å­¦ç¿’ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number" id="totalSessions">0</span>
                    <span class="stat-label">ç·å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="totalTime">0</span>
                    <span class="stat-label">ç·å­¦ç¿’æ™‚é–“ (åˆ†)</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="integrationScore">0</span>
                    <span class="stat-label">çµ±åˆåº¦ã‚¹ã‚³ã‚¢</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="completedExercises">0</span>
                    <span class="stat-label">å®Œäº†æ¼”ç¿’æ•°</span>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ“Š ä»Šæ—¥ã®å­¦ç¿’çŠ¶æ³</h3>
                    <div class="card-content">
                        <p>å­¦ç¿’æ™‚é–“: <span id="todayTime">0</span> åˆ†</p>
                        <p>å®Œäº†ã—ãŸæ¼”ç¿’: <span id="todayExercises">0</span> å•</p>
                        <p>æ´»ç”¨ã—ãŸåˆ†é‡: <span id="todayDomains">0</span> åˆ†é‡</p>
                        <p>çµ±åˆåº¦å‘ä¸Š: +<span id="todayIntegration">0</span> ãƒã‚¤ãƒ³ãƒˆ</p>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ¯ æ¨å¥¨å­¦ç¿’ãƒ‘ã‚¹</h3>
                    <div class="card-content" id="recommendedPath">
                        <p>ã‚ãªãŸã®å­¦ç¿’å±¥æ­´ã‚’åˆ†æä¸­...</p>
                        <button class="btn btn-success" onclick="generateRecommendation()">
                            ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰æ¨å¥¨ã‚’å–å¾—
                        </button>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ† æœ€è¿‘ã®æˆæœ</h3>
                    <div class="card-content" id="recentAchievements">
                        <p>æ–°ã—ã„æˆæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ”— åˆ†é‡é–“é€£æº</h3>
                    <div class="card-content">
                        <p>æœ€ã‚‚å¼·ã„é€£æº: <span id="strongestConnection">åˆ†æä¸­</span></p>
                        <p>ç™ºè¦‹ã•ã‚ŒãŸé–¢é€£æ€§: <span id="discoveredConnections">0</span> å€‹</p>
                        <p>çµ±åˆãƒ¬ãƒ™ãƒ«: <span id="integrationLevel">åˆç´š</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Domains Tab -->
        <div id="domains" class="tab-content">
            <h2>å­¦ç¿’åˆ†é‡</h2>
            <p>6ã¤ã®æ€è€ƒåˆ†é‡ã‚’çµ±åˆã—ã¦ã€å­¦éš›çš„ãªç†è§£ã‚’æ·±ã‚ã¾ã—ã‚‡ã†ã€‚</p>
            
            <div class="domain-grid">
                <div class="domain-card domain-math">
                    <div class="domain-header">
                        <div class="domain-icon math-icon">âˆ‘</div>
                        <div class="domain-title">æ•°å­¦çš„æ€è€ƒ</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 65%; background: linear-gradient(90deg, #ff6b6b, #ee5a6f);"></div>
                    </div>
                    <p>è«–ç†çš„æ¨è«–ã€æ•°å¼å±•é–‹ã€çµ±è¨ˆåˆ†æã®åŸºç¤ã‚’å­¦ç¿’ã—ã€å®šé‡çš„æ€è€ƒåŠ›ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚</p>
                    <div class="exercise-container">
                        <div class="exercise-question">å¾®åˆ†ã®å¿œç”¨: f(x) = xÂ³ - 3xÂ² + 2x ã®æ¥µå€¤ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚</div>
                        <button class="btn" onclick="solveMathProblem()">æ¼”ç¿’ã‚’é–‹å§‹</button>
                    </div>
                </div>
                
                <div class="domain-card domain-physics">
                    <div class="domain-header">
                        <div class="domain-icon physics-icon">âš›</div>
                        <div class="domain-title">ç‰©ç†çš„æ€è€ƒ</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 52%; background: linear-gradient(90deg, #4ecdc4, #44a08d);"></div>
                    </div>
                    <p>è‡ªç„¶ç¾è±¡ã®ãƒ¢ãƒ‡ãƒ«åŒ–ã€å®Ÿé¨“çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã€ç‰©ç†æ³•å‰‡ã®ç†è§£ã‚’é€šã˜ã¦ç§‘å­¦çš„æ€è€ƒã‚’é¤Šã„ã¾ã™ã€‚</p>
                    <div class="exercise-container">
                        <div class="exercise-question">é‹å‹•é‡ä¿å­˜: è³ªé‡2kgã®ç‰©ä½“ãŒ5m/sã§é‹å‹•ã—ã¦ã„ã‚‹æ™‚ã®é‹å‹•é‡ã¯ï¼Ÿ</div>
                        <button class="btn" onclick="solvePhysicsProblem()">æ¼”ç¿’ã‚’é–‹å§‹</button>
                    </div>
                </div>
                
                <div class="domain-card domain-logic">
                    <div class="domain-header">
                        <div class="domain-icon logic-icon">âŠ¨</div>
                        <div class="domain-title">è«–ç†çš„æ€è€ƒ</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 78%; background: linear-gradient(90deg, #45b7d1, #3867d6);"></div>
                    </div>
                    <p>æ¼”ç¹¹çš„æ¨è«–ã€å¸°ç´çš„æ¨è«–ã€æ‰¹åˆ¤çš„æ€è€ƒã‚¹ã‚­ãƒ«ã‚’é€šã˜ã¦è«–ç†çš„ãªå•é¡Œè§£æ±ºèƒ½åŠ›ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚</p>
                    <div class="exercise-container">
                        <div class="exercise-question">è«–ç†ãƒ‘ã‚ºãƒ«: Aã¯Bã‚ˆã‚ŠèƒŒãŒé«˜ãã€Bã¯Cã‚ˆã‚ŠèƒŒãŒé«˜ã„ã€‚æœ€ã‚‚èƒŒãŒé«˜ã„ã®ã¯ï¼Ÿ</div>
                        <button class="btn" onclick="solveLogicProblem()">æ¼”ç¿’ã‚’é–‹å§‹</button>
                    </div>
                </div>
                
                <div class="domain-card domain-creative">
                    <div class="domain-header">
                        <div class="domain-icon creative-icon">ğŸ¨</div>
                        <div class="domain-title">å‰µé€ çš„æ€è€ƒ</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 43%; background: linear-gradient(90deg, #96ceb4, #79b8a3);"></div>
                    </div>
                    <p>ã‚¢ã‚¤ãƒ‡ã‚¢ç”Ÿæˆã€æ¦‚å¿µã®çµ„ã¿åˆã‚ã›ã€æ–°ã—ã„è¦–ç‚¹ã®ç™ºè¦‹ã‚’é€šã˜ã¦å‰µé€ æ€§ã‚’é–‹ç™ºã—ã¾ã™ã€‚</p>
                    <div class="exercise-container">
                        <div class="exercise-question">å‰µé€ çš„ç™ºæƒ³: ã€Œæ™‚é–“ã€ã¨ã€Œè‰²ã€ã‚’çµ„ã¿åˆã‚ã›ãŸæ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è€ƒæ¡ˆã—ã¦ãã ã•ã„ã€‚</div>
                        <button class="btn" onclick="solveCreativeProblem()">æ¼”ç¿’ã‚’é–‹å§‹</button>
                    </div>
                </div>
                
                <div class="domain-card domain-music">
                    <div class="domain-header">
                        <div class="domain-icon music-icon">â™ª</div>
                        <div class="domain-title">éŸ³æ¥½çš„æ€è€ƒ</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 61%; background: linear-gradient(90deg, #feca57, #ff9ff3);"></div>
                    </div>
                    <p>ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ã€èª¿å’Œç†è«–ã€ãƒªã‚ºãƒ æ§‹é€ ã‚’é€šã˜ã¦éŸ³æ¥½çš„ãªæ€è€ƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç†è§£ã—ã¾ã™ã€‚</p>
                    <div class="exercise-container">
                        <div class="exercise-question">éŸ³æ¥½ç†è«–: Cãƒ¡ã‚¸ãƒ£ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«ã®ç¬¬3éŸ³ã¨ç¬¬7éŸ³ã¯ä½•ã§ã™ã‹ï¼Ÿ</div>
                        <button class="btn" onclick="solveMusicProblem()">æ¼”ç¿’ã‚’é–‹å§‹</button>
                    </div>
                </div>
                
                <div class="domain-card domain-language">
                    <div class="domain-header">
                        <div class="domain-icon language-icon">ğŸ’¬</div>
                        <div class="domain-title">è¨€èªçš„æ€è€ƒ</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 71%; background: linear-gradient(90deg, #ff9ff3, #ff6b6b);"></div>
                    </div>
                    <p>æ¦‚å¿µæ•´ç†ã€æ–‡è„ˆç†è§£ã€è¡¨ç¾æŠ€æ³•ã‚’é€šã˜ã¦è¨€èªã«ã‚ˆã‚‹æ€è€ƒã¨è¡¨ç¾èƒ½åŠ›ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚</p>
                    <div class="exercise-container">
                        <div class="exercise-question">èªå½™æ‹¡å¼µ: ã€Œå”åƒã€ã®é¡ç¾©èªã‚’3ã¤ä»¥ä¸ŠæŒ™ã’ã€ãã‚Œãã‚Œã®å¾®å¦™ãªé•ã„ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</div>
                        <button class="btn" onclick="solveLanguageProblem()">æ¼”ç¿’ã‚’é–‹å§‹</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Exercises Tab -->
        <div id="exercises" class="tab-content">
            <h2>çµ±åˆæ¼”ç¿’</h2>
            <p>è¤‡æ•°ã®åˆ†é‡ã‚’çµ„ã¿åˆã‚ã›ãŸèª²é¡Œã§ã€å­¦éš›çš„æ€è€ƒåŠ›ã‚’é›ãˆã¾ã—ã‚‡ã†ã€‚</p>
            
            <div class="exercise-container">
                <h3>ğŸ”€ åˆ†é‡æ¨ªæ–­ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h3>
                <div class="exercise-question" id="integrationQuestion">
                    çµ±åˆå•é¡Œã‚’ç”Ÿæˆä¸­...
                </div>
                <div class="exercise-options" id="integrationOptions">
                    <!-- Options will be populated by JavaScript -->
                </div>
                <button class="btn" onclick="generateIntegrationExercise()">æ–°ã—ã„çµ±åˆå•é¡Œã‚’ç”Ÿæˆ</button>
                <button class="btn btn-success" onclick="checkIntegrationAnswer()" id="checkIntegrationBtn" style="display: none;">å›ç­”ã‚’ç¢ºèª</button>
            </div>
            
            <div class="exercise-container">
                <h3>ğŸ“ ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£</h3>
                <div id="caseStudy">
                    <h4>ç¾åœ¨ã®ã‚±ãƒ¼ã‚¹: éƒ½å¸‚äº¤é€šã‚·ã‚¹ãƒ†ãƒ ã®æœ€é©åŒ–</h4>
                    <p>
                        å¤§éƒ½å¸‚ã®äº¤é€šæ¸‹æ»å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®è¦³ç‚¹ã‹ã‚‰ç·åˆçš„ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è€ƒæ¡ˆã—ã¦ãã ã•ã„ï¼š
                    </p>
                    <ul>
                        <li><strong>æ•°å­¦çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> äº¤é€šæµã®æ•°ç†ãƒ¢ãƒ‡ãƒ«åŒ–</li>
                        <li><strong>ç‰©ç†çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> è»Šä¸¡é‹å‹•ã®åŠ›å­¦çš„åˆ†æ</li>
                        <li><strong>è«–ç†çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> æœ€é©ãƒ«ãƒ¼ãƒˆé¸æŠã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </li>
                        <li><strong>å‰µé€ çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> é©æ–°çš„ãªäº¤é€šæ‰‹æ®µã®ææ¡ˆ</li>
                        <li><strong>éŸ³æ¥½çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> äº¤é€šãƒªã‚ºãƒ ã®èª¿å’Œç†è«–</li>
                        <li><strong>è¨€èªçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> åˆ©ç”¨è€…ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥</li>
                    </ul>
                    <textarea id="caseStudyResponse" rows="6" style="width: 100%; margin-top: 1rem; padding: 1rem; border-radius: 10px; border: 2px solid #e2e8f0;" placeholder="ã‚ãªãŸã®çµ±åˆçš„è§£æ±ºç­–ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„..."></textarea>
                    <br>
                    <button class="btn" onclick="submitCaseStudy()">è§£æ±ºç­–ã‚’æå‡º</button>
                    <button class="btn" onclick="loadNewCaseStudy()">æ–°ã—ã„ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£</button>
                </div>
            </div>
        </div>

        <!-- Integration Map Tab -->
        <div id="integration" class="tab-content">
            <h2>é–¢é€£æ€§ãƒãƒƒãƒ—</h2>
            <p>å­¦ç¿’åˆ†é‡é–“ã®é–¢é€£æ€§ã‚’è¦–è¦šçš„ã«æ¢ç´¢ã—ã€æ–°ã—ã„çŸ¥è­˜ã®ç¹‹ãŒã‚Šã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚</p>
            
            <div class="integration-map" id="relationshipMap">
                <canvas id="mapCanvas" width="100%" height="400"></canvas>
            </div>
            
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ”— ç™ºè¦‹ã•ã‚ŒãŸé–¢é€£æ€§</h3>
                    <div class="card-content" id="discoveredRelations">
                        <p>æ•°å­¦ â†” éŸ³æ¥½: ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã¨éŸ³éŸ¿ç†è«–</p>
                        <p>ç‰©ç† â†” å‰µé€ : å…‰å­¦ç¾è±¡ã¨ã‚¢ãƒ¼ãƒˆè¡¨ç¾</p>
                        <p>è«–ç† â†” è¨€èª: æ¨è«–æ§‹é€ ã¨æ–‡æ³•ä½“ç³»</p>
                        <p>å‰µé€  â†” æ•°å­¦: é»„é‡‘æ¯”ã¨ç¾çš„èª¿å’Œ</p>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ’¡ çµ±åˆã®ãƒ’ãƒ³ãƒˆ</h3>
                    <div class="card-content" id="integrationHints">
                        <p>â€¢ ç•°ãªã‚‹åˆ†é‡ã®æ¦‚å¿µã‚’æ¯”å–©ã§ç¹‹ã’ã¦ã¿ã¾ã—ã‚‡ã†</p>
                        <p>â€¢ å…±é€šã™ã‚‹æ•°å­¦çš„æ§‹é€ ã‚’æ¢ã—ã¦ã¿ã¾ã—ã‚‡ã†</p>
                        <p>â€¢ å®Ÿä¸–ç•Œã®ç¾è±¡ã‚’å¤šè§’çš„ã«åˆ†æã—ã¦ã¿ã¾ã—ã‚‡ã†</p>
                        <p>â€¢ æŠ½è±¡çš„æ¦‚å¿µã‚’å…·ä½“ä¾‹ã§è¡¨ç¾ã—ã¦ã¿ã¾ã—ã‚‡ã†</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Tab -->
        <div id="progress" class="tab-content">
            <h2>é€²æ—åˆ†æ</h2>
            <p>å­¦ç¿’ã®é€²æ—ã‚’è©³ç´°ã«åˆ†æã—ã€æˆé•·ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠŠæ¡ã—ã¾ã—ã‚‡ã†ã€‚</p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number" id="progressWeeklyTime">0</span>
                    <span class="stat-label">ä»Šé€±ã®å­¦ç¿’æ™‚é–“</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="progressAccuracy">0%</span>
                    <span class="stat-label">ç·åˆæ­£ç­”ç‡</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="progressStreak">0</span>
                    <span class="stat-label">é€£ç¶šå­¦ç¿’æ—¥æ•°</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="progressLevel">1</span>
                    <span class="stat-label">çµ±åˆãƒ¬ãƒ™ãƒ«</span>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ“ˆ å­¦ç¿’æ›²ç·š</h3>
                    <div class="card-content">
                        <canvas id="progressChart" width="300" height="200"></canvas>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ¯ åˆ†é‡åˆ¥ç¿’ç†Ÿåº¦</h3>
                    <div class="card-content">
                        <div>æ•°å­¦: <div class="progress-bar"><div class="progress-fill" style="width: 65%; background: #ff6b6b;"></div></div></div>
                        <div>ç‰©ç†: <div class="progress-bar"><div class="progress-fill" style="width: 52%; background: #4ecdc4;"></div></div></div>
                        <div>è«–ç†: <div class="progress-bar"><div class="progress-fill" style="width: 78%; background: #45b7d1;"></div></div></div>
                        <div>å‰µé€ : <div class="progress-bar"><div class="progress-fill" style="width: 43%; background: #96ceb4;"></div></div></div>
                        <div>éŸ³æ¥½: <div class="progress-bar"><div class="progress-fill" style="width: 61%; background: #feca57;"></div></div></div>
                        <div>è¨€èª: <div class="progress-bar"><div class="progress-fill" style="width: 71%; background: #ff9ff3;"></div></div></div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ… é”æˆãƒãƒƒã‚¸</h3>
                    <div class="card-content" id="achievementBadges">
                        <p>ğŸ”¢ æ•°å­¦ãƒã‚¹ã‚¿ãƒ¼ (ãƒ¬ãƒ™ãƒ«1)</p>
                        <p>ğŸ¼ éŸ³æ¥½ç†è«–å®¶ (ãƒ¬ãƒ™ãƒ«1)</p>
                        <p>ğŸ”— çµ±åˆæ€è€ƒè€… (ãƒ¬ãƒ™ãƒ«1)</p>
                        <p>ğŸ“š ç¶™ç¶šå­¦ç¿’è€… (7æ—¥é€£ç¶š)</p>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3 class="card-title">ğŸ² å­¦ç¿’æ¨å¥¨</h3>
                    <div class="card-content" id="learningRecommendations">
                        <p>â€¢ å‰µé€ çš„æ€è€ƒåˆ†é‡ã®å¼·åŒ–ã‚’æ¨å¥¨</p>
                        <p>â€¢ ç‰©ç†-æ•°å­¦ã®çµ±åˆæ¼”ç¿’ã«æŒ‘æˆ¦</p>
                        <p>â€¢ è¨€èªè¡¨ç¾åŠ›å‘ä¸Šã®ãŸã‚ã®å®Ÿè·µ</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logs Tab -->
        <div id="logs" class="tab-content">
            <h2>å­¦ç¿’ãƒ­ã‚°</h2>
            <p>è©³ç´°ãªå­¦ç¿’å±¥æ­´ã¨ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œè¨˜éŒ²ã‚’ç¢ºèªã§ãã¾ã™ã€‚</p>
            
            <button class="btn" onclick="exportLogs()">ãƒ­ã‚°ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
            <button class="btn" onclick="clearLogs()">ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢</button>
            <button class="btn btn-success" onclick="refreshLogs()">ãƒ­ã‚°ã‚’æ›´æ–°</button>
            
            <div class="log-container" id="systemLogs">
                <!-- Logs will be populated here -->
            </div>
        </div>
    </main>

    <script>
    // Global variables
    let currentTab = 'dashboard';
    let userProgress = {
        sessions: 0,
        totalTime: 0,
        integrationScore: 0,
        completedExercises: 0,
        todayTime: 0,
        todayExercises: 0,
        todayDomains: 0,
        todayIntegration: 0,
        weeklyTime: 0,
        accuracy: 0,
        streak: 0,
        level: 1,
        domainProgress: {
            math: 65,
            physics: 52,
            logic: 78,
            creative: 43,
            music: 61,
            language: 71
        },
        achievements: []
    };
    let logs = [];
    let sessionStartTime = Date.now();

    // Initialize the application
    document.addEventListener('DOMContentLoaded', function() {
        initializeApp();
        createFloatingParticles();
        loadUserProgress();
        updateDashboard();
        logAction('ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹', 'ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†');
    });

    function initializeApp() {
        // Setup canvas for integration map
        const canvas = document.getElementById('mapCanvas');
        if (canvas) {
            const ctx = canvas.getContext('2d');
            drawIntegrationMap(ctx);
        }
        
        // Load saved progress
        const savedProgress = localStorage.getItem('ikipProgress');
        if (savedProgress) {
            userProgress = { ...userProgress, ...JSON.parse(savedProgress) };
        }
        
        // Update display
        updateAllDisplays();
    }

    function showTab(tabName) {
        // Hide all tabs
        const tabs = document.querySelectorAll('.tab-content');
        tabs.forEach(tab => {
            tab.classList.remove('active');
        });
        
        // Remove active class from all nav tabs
        const navTabs = document.querySelectorAll('.nav-tab');
        navTabs.forEach(tab => {
            tab.classList.remove('active');
        });
        
        // Show selected tab
        document.getElementById(tabName).classList.add('active');
        
        // Add active class to clicked nav tab
        event.target.classList.add('active');
        
        currentTab = tabName;
        logAction('ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ', `${tabName}ã‚¿ãƒ–ã‚’è¡¨ç¤º`);
        
        // Trigger specific tab initialization
        if (tabName === 'integration') {
            setTimeout(() => drawIntegrationMap(), 100);
        } else if (tabName === 'progress') {
            setTimeout(() => drawProgressChart(), 100);
        }
    }

    function updateDashboard() {
        document.getElementById('totalSessions').textContent = userProgress.sessions;
        document.getElementById('totalTime').textContent = userProgress.totalTime;
        document.getElementById('integrationScore').textContent = userProgress.integrationScore;
        document.getElementById('completedExercises').textContent = userProgress.completedExercises;
        
        document.getElementById('todayTime').textContent = userProgress.todayTime;
        document.getElementById('todayExercises').textContent = userProgress.todayExercises;
        document.getElementById('todayDomains').textContent = userProgress.todayDomains;
        document.getElementById('todayIntegration').textContent = userProgress.todayIntegration;
        
        document.getElementById('progressWeeklyTime').textContent = userProgress.weeklyTime;
        document.getElementById('progressAccuracy').textContent = userProgress.accuracy;
        document.getElementById('progressStreak').textContent = userProgress.streak;
        document.getElementById('progressLevel').textContent = userProgress.level;
        
        // Update connection info
        document.getElementById('strongestConnection').textContent = 'æ•°å­¦ â†” éŸ³æ¥½';
        document.getElementById('discoveredConnections').textContent = '12';
        document.getElementById('integrationLevel').textContent = userProgress.level >= 3 ? 'ä¸Šç´š' : userProgress.level >= 2 ? 'ä¸­ç´š' : 'åˆç´š';
    }

    function updateAllDisplays() {
        updateDashboard();
        updateAchievements();
        updateRecommendations();
    }

    function updateAchievements() {
        const achievementsDiv = document.getElementById('recentAchievements');
        const achievements = [
            'ğŸ¯ åˆå›çµ±åˆæ¼”ç¿’å®Œäº†',
            'ğŸ“Š ãƒ‡ãƒ¼ã‚¿åˆ†æãƒãƒƒã‚¸ç²å¾—',
            'ğŸ”— åˆ†é‡é–“é–¢é€£æ€§ç™ºè¦‹',
            'â­ å­¦ç¿’ç¶™ç¶š7æ—¥é”æˆ'
        ];
        achievementsDiv.innerHTML = achievements.map(achievement => `<p>${achievement}</p>`).join('');
    }

    function updateRecommendations() {
        const recommendationsDiv = document.getElementById('learningRecommendations');
        const recommendations = [
            'â€¢ å‰µé€ çš„æ€è€ƒåˆ†é‡ã®å¼·åŒ–ã‚’æ¨å¥¨',
            'â€¢ ç‰©ç†-æ•°å­¦ã®çµ±åˆæ¼”ç¿’ã«æŒ‘æˆ¦',
            'â€¢ è¨€èªè¡¨ç¾åŠ›å‘ä¸Šã®ãŸã‚ã®å®Ÿè·µ',
            'â€¢ éŸ³æ¥½ç†è«–ã¨æ•°å­¦ã®é–¢é€£æ€§æ¢æ±‚'
        ];
        recommendationsDiv.innerHTML = recommendations.join('<br>');
    }

    function generateRecommendation() {
        const pathDiv = document.getElementById('recommendedPath');
        const paths = [
            'æ•°å­¦åŸºç¤ â†’ ç‰©ç†å¿œç”¨ â†’ éŸ³æ¥½ç†è«–çµ±åˆ',
            'è¨€èªåˆ†æ â†’ è«–ç†æ§‹é€  â†’ å‰µé€ çš„è¡¨ç¾',
            'å‰µé€ ç™ºæƒ³ â†’ æ•°å­¦ãƒ¢ãƒ‡ãƒ« â†’ å®Ÿè£…æ¤œè¨¼',
            'éŸ³æ¥½ãƒ‘ã‚¿ãƒ¼ãƒ³ â†’ ç‰©ç†æ³¢å‹• â†’ æ•°å­¦é–¢æ•°'
        ];
        const randomPath = paths[Math.floor(Math.random() * paths.length)];
        pathDiv.innerHTML = `<p><strong>æ¨å¥¨å­¦ç¿’ãƒ‘ã‚¹:</strong></p><p>${randomPath}</p>`;
        logAction('æ¨å¥¨ç”Ÿæˆ', `å­¦ç¿’ãƒ‘ã‚¹: ${randomPath}`);
    }

    // Domain-specific exercise functions
    function solveMathProblem() {
        const result = prompt('f\'(x) = 3xÂ² - 6x + 2 = 0 ã‚’è§£ã„ã¦æ¥µå€¤ã®xåº§æ¨™ã‚’æ±‚ã‚ã¦ãã ã•ã„:');
        if (result !== null) {
            userProgress.completedExercises++;
            userProgress.todayExercises++;
            userProgress.integrationScore += 5;
            logAction('æ•°å­¦æ¼”ç¿’', `å›ç­”: ${result}`);
            alert('æ•°å­¦æ¼”ç¿’å®Œäº†ï¼çµ±åˆã‚¹ã‚³ã‚¢ +5 ãƒã‚¤ãƒ³ãƒˆ');
            updateDashboard();
            saveProgress();
        }
    }

    function solvePhysicsProblem() {
        const result = prompt('é‹å‹•é‡ = è³ªé‡ Ã— é€Ÿåº¦ã€‚2kg Ã— 5m/s = ?');
        if (result !== null) {
            userProgress.completedExercises++;
            userProgress.todayExercises++;
            userProgress.integrationScore += 5;
            logAction('ç‰©ç†æ¼”ç¿’', `å›ç­”: ${result}`);
            alert('ç‰©ç†æ¼”ç¿’å®Œäº†ï¼çµ±åˆã‚¹ã‚³ã‚¢ +5 ãƒã‚¤ãƒ³ãƒˆ');
            updateDashboard();
            saveProgress();
        }
    }

    function solveLogicProblem() {
        const result = prompt('A > B > C ãªã®ã§ã€æœ€ã‚‚èƒŒãŒé«˜ã„ã®ã¯ï¼Ÿ');
        if (result !== null) {
            userProgress.completedExercises++;
            userProgress.todayExercises++;
            userProgress.integrationScore += 5;
            logAction('è«–ç†æ¼”ç¿’', `å›ç­”: ${result}`);
            alert('è«–ç†æ¼”ç¿’å®Œäº†ï¼çµ±åˆã‚¹ã‚³ã‚¢ +5 ãƒã‚¤ãƒ³ãƒˆ');
            updateDashboard();
            saveProgress();
        }
    }

    function solveCreativeProblem() {
        const result = prompt('ã€Œæ™‚é–“ã€ã¨ã€Œè‰²ã€ã‚’çµ„ã¿åˆã‚ã›ãŸã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
        if (result !== null) {
            userProgress.completedExercises++;
            userProgress.todayExercises++;
            userProgress.integrationScore += 8;
            logAction('å‰µé€ æ¼”ç¿’', `ã‚¢ã‚¤ãƒ‡ã‚¢: ${result}`);
            alert('å‰µé€ æ¼”ç¿’å®Œäº†ï¼çµ±åˆã‚¹ã‚³ã‚¢ +8 ãƒã‚¤ãƒ³ãƒˆ');
            updateDashboard();
            saveProgress();
        }
    }

    function solveMusicProblem() {
        const result = prompt('Cãƒ¡ã‚¸ãƒ£ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«: C-D-E-F-G-A-Bã€‚ç¬¬3éŸ³ã¨ç¬¬7éŸ³ã¯ï¼Ÿ');
        if (result !== null) {
            userProgress.completedExercises++;
            userProgress.todayExercises++;
            userProgress.integrationScore += 5;
            logAction('éŸ³æ¥½æ¼”ç¿’', `å›ç­”: ${result}`);
            alert('éŸ³æ¥½æ¼”ç¿’å®Œäº†ï¼çµ±åˆã‚¹ã‚³ã‚¢ +5 ãƒã‚¤ãƒ³ãƒˆ');
            updateDashboard();
            saveProgress();
        }
    }

    function solveLanguageProblem() {
        const result = prompt('ã€Œå”åƒã€ã®é¡ç¾©èªã‚’3ã¤ä»¥ä¸Šã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å…¥åŠ›ã—ã¦ãã ã•ã„:');
        if (result !== null) {
            userProgress.completedExercises++;
            userProgress.todayExercises++;
            userProgress.integrationScore += 6;
            logAction('è¨€èªæ¼”ç¿’', `é¡ç¾©èª: ${result}`);
            alert('è¨€èªæ¼”ç¿’å®Œäº†ï¼çµ±åˆã‚¹ã‚³ã‚¢ +6 ãƒã‚¤ãƒ³ãƒˆ');
            updateDashboard();
            saveProgress();
        }
    }

    // Integration exercise functions
    function generateIntegrationExercise() {
        const questions = [
            {
                question: 'éŸ³æ¥½ã®å‘¨æ³¢æ•°440Hzï¼ˆãƒ©ã®éŸ³ï¼‰ã‚’æ•°å­¦çš„ã«è¡¨ç¾ã—ã€ã“ã®å‘¨æ³¢æ•°ãŒæŒã¤ç‰©ç†çš„ç‰¹æ€§ã‚’å‰µé€ çš„ã«æ´»ç”¨ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚',
                options: [
                    'ãƒ‡ã‚¸ã‚¿ãƒ«æ¥½å™¨ã®éŸ³è³ªæ”¹å–„ã‚·ã‚¹ãƒ†ãƒ ',
                    'å»ºç¯‰éŸ³éŸ¿ã®æœ€é©åŒ–ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³',
                    'åŒ»ç™‚ç”¨éŸ³éŸ¿æ²»ç™‚è£…ç½®',
                    'ç’°å¢ƒéŸ³ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ '
                ],
                correct: 0
            },
            {
                question: 'é»„é‡‘æ¯”Ï† â‰ˆ 1.618ãŒè‡ªç„¶ç•Œã«ç¾ã‚Œã‚‹ç†ç”±ã‚’ç‰©ç†å­¦ãƒ»æ•°å­¦ãƒ»èŠ¸è¡“ã®è¦³ç‚¹ã‹ã‚‰çµ±åˆçš„ã«èª¬æ˜ã—ã€ã“ã‚Œã‚’è¨€èªã§è¡¨ç¾ã—ã¦ãã ã•ã„ã€‚',
                options: [
                    'ã‚¨ãƒãƒ«ã‚®ãƒ¼åŠ¹ç‡ã®æœ€é©åŒ–ç†è«–',
                    'è¦–è¦šçš„ç¾æ„Ÿã®æ•°ç†æ§‹é€ ',
                    'æˆé•·ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åŠ›å­¦çš„å®‰å®šæ€§',
                    'ã™ã¹ã¦ã®è¦³ç‚¹ãŒç›¸äº’é–¢é€£ã—ã¦ã„ã‚‹'
                ],
                correct: 3
            }
        ];
        
        const question = questions[Math.floor(Math.random() * questions.length)];
        document.getElementById('integrationQuestion').textContent = question.question;
        
        const optionsDiv = document.getElementById('integrationOptions');
        optionsDiv.innerHTML = '';
        
        question.options.forEach((option, index) => {
            const optionDiv = document.createElement('div');
            optionDiv.className = 'exercise-option';
            optionDiv.textContent = option;
            optionDiv.onclick = () => selectIntegrationOption(index);
            optionDiv.dataset.index = index;
            optionsDiv.appendChild(optionDiv);
        });
        
        document.getElementById('checkIntegrationBtn').style.display = 'inline-block';
        document.getElementById('checkIntegrationBtn').dataset.correct = question.correct;
        
        logAction('çµ±åˆæ¼”ç¿’ç”Ÿæˆ', 'æ–°ã—ã„çµ±åˆå•é¡Œã‚’ç”Ÿæˆ');
    }

    function selectIntegrationOption(index) {
        const options = document.querySelectorAll('.exercise-option');
        options.forEach(option => option.classList.remove('selected'));
        options[index].classList.add('selected');
        document.getElementById('checkIntegrationBtn').dataset.selected = index;
    }

    function checkIntegrationAnswer() {
        const selected = parseInt(document.getElementById('checkIntegrationBtn').dataset.selected);
        const correct = parseInt(document.getElementById('checkIntegrationBtn').dataset.correct);
        
        const options = document.querySelectorAll('.exercise-option');
        
        if (selected === correct) {
            options[selected].classList.add('correct');
            userProgress.integrationScore += 15;
            userProgress.completedExercises++;
            userProgress.todayExercises++;
            userProgress.todayIntegration += 15;
            alert('æ­£è§£ï¼çµ±åˆçš„æ€è€ƒåŠ›ãŒå‘ä¸Šã—ã¾ã—ãŸã€‚+15 ãƒã‚¤ãƒ³ãƒˆ');
            logAction('çµ±åˆæ¼”ç¿’', 'æ­£è§£ - çµ±åˆã‚¹ã‚³ã‚¢ +15');
        } else {
            options[selected].classList.add('incorrect');
            options[correct].classList.add('correct');
            userProgress.integrationScore += 5;
            alert('æƒœã—ã„ï¼ç•°ãªã‚‹è¦–ç‚¹ã‹ã‚‰ã®è€ƒå¯Ÿã§ +5 ãƒã‚¤ãƒ³ãƒˆ');
            logAction('çµ±åˆæ¼”ç¿’', 'ä¸æ­£è§£ - å­¦ç¿’ç¶™ç¶š +5');
        }
        
        updateDashboard();
        saveProgress();
        
        setTimeout(() => {
            options.forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
            document.getElementById('checkIntegrationBtn').style.display = 'none';
        }, 3000);
    }

    function submitCaseStudy() {
        const response = document.getElementById('caseStudyResponse').value;
        if (response.trim().length > 50) {
            userProgress.integrationScore += 25;
            userProgress.completedExercises++;
            userProgress.todayExercises++;
            userProgress.todayIntegration += 25;
            logAction('ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£', `è§£æ±ºç­–æå‡º: ${response.substring(0, 100)}...`);
            alert('ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£å®Œäº†ï¼ç·åˆçš„æ€è€ƒåŠ›ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã—ãŸã€‚+25 ãƒã‚¤ãƒ³ãƒˆ');
            updateDashboard();
            saveProgress();
        } else {
            alert('ã‚ˆã‚Šè©³ç´°ãªå›ç­”ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼ˆ50æ–‡å­—ä»¥ä¸Šï¼‰');
        }
    }

    function loadNewCaseStudy() {
        const cases = [
            {
                title: 'æŒç¶šå¯èƒ½ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆ',
                description: 'å†ç”Ÿå¯èƒ½ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ´»ç”¨ã—ãŸåœ°åŸŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã‚’ã€æŠ€è¡“ãƒ»çµŒæ¸ˆãƒ»ç¤¾ä¼šã®è¦³ç‚¹ã‹ã‚‰è¨­è¨ˆã—ã¦ãã ã•ã„ã€‚'
            },
            {
                title: 'æ•™è‚²æ”¹é©ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç«‹æ¡ˆ',
                description: '21ä¸–ç´€ã‚¹ã‚­ãƒ«ã‚’è‚²æˆã™ã‚‹æ–°ã—ã„æ•™è‚²ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã€èªçŸ¥ç§‘å­¦ãƒ»æŠ€è¡“ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¦–ç‚¹ã‹ã‚‰ææ¡ˆã—ã¦ãã ã•ã„ã€‚'
            },
            {
                title: 'éƒ½å¸‚ç©ºé–“ã®å†è¨­è¨ˆ',
                description: 'ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®çµ†ã‚’æ·±ã‚ã‚‹éƒ½å¸‚ç©ºé–“ã‚’ã€å»ºç¯‰ãƒ»å¿ƒç†å­¦ãƒ»ç¤¾ä¼šå­¦ãƒ»ã‚¢ãƒ¼ãƒˆã®è¦³ç‚¹ã‹ã‚‰å†è¨­è¨ˆã—ã¦ãã ã•ã„ã€‚'
            }
        ];
        
        const randomCase = cases[Math.floor(Math.random() * cases.length)];
        document.getElementById('caseStudy').innerHTML = `
            <h4>ç¾åœ¨ã®ã‚±ãƒ¼ã‚¹: ${randomCase.title}</h4>
            <p>${randomCase.description}</p>
            <textarea id="caseStudyResponse" rows="6" style="width: 100%; margin-top: 1rem; padding: 1rem; border-radius: 10px; border: 2px solid #e2e8f0;" placeholder="ã‚ãªãŸã®çµ±åˆçš„è§£æ±ºç­–ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„..."></textarea>
            <br>
            <button class="btn" onclick="submitCaseStudy()">è§£æ±ºç­–ã‚’æå‡º</button>
            <button class="btn" onclick="loadNewCaseStudy()">æ–°ã—ã„ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£</button>
        `;
        
        logAction('ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£', `æ–°ã—ã„ã‚±ãƒ¼ã‚¹èª­ã¿è¾¼ã¿: ${randomCase.title}`);
    }

    // Visualization functions
    function drawIntegrationMap() {
        const canvas = document.getElementById('mapCanvas');
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        canvas.width = canvas.offsetWidth;
        canvas.height = 400;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Draw domain nodes
        const domains = [
            { name: 'æ•°å­¦', x: 150, y: 100, color: '#ff6b6b' },
            { name: 'ç‰©ç†', x: 350, y: 80, color: '#4ecdc4' },
            { name: 'è«–ç†', x: 500, y: 150, color: '#45b7d1' },
            { name: 'å‰µé€ ', x: 400, y: 280, color: '#96ceb4' },
            { name: 'éŸ³æ¥½', x: 250, y: 320, color: '#feca57' },
            { name: 'è¨€èª', x: 100, y: 250, color: '#ff9ff3' }
        ];
        
        // Draw connections
        const connections = [
            [0, 1], [0, 4], [1, 2], [1, 3], [2, 5], [3, 4], [4, 5], [5, 0]
        ];
        
        ctx.strokeStyle = '#cbd5e0';
        ctx.lineWidth = 2;
        connections.forEach(([i, j]) => {
            ctx.beginPath();
            ctx.moveTo(domains[i].x, domains[i].y);
            ctx.lineTo(domains[j].x, domains[j].y);
            ctx.stroke();
        });
        
        // Draw nodes
        domains.forEach(domain => {
            ctx.beginPath();
            ctx.arc(domain.x, domain.y, 25, 0, 2 * Math.PI);
            ctx.fillStyle = domain.color;
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 12px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(domain.name, domain.x, domain.y + 4);
        });
        
        logAction('å¯è¦–åŒ–', 'é–¢é€£æ€§ãƒãƒƒãƒ—ã‚’æç”»');
    }

    function drawProgressChart() {
        const canvas = document.getElementById('progressChart');
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        canvas.width = 300;
        canvas.height = 200;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Sample progress data
        const data = [10, 25, 45, 65, 80, 95, 120];
        const labels = ['æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ', 'æ—¥'];
        
        // Draw grid
        ctx.strokeStyle = '#e2e8f0';
        ctx.lineWidth = 1;
        for (let i = 0; i <= 5; i++) {
            const y = 20 + (i * 30);
            ctx.beginPath();
            ctx.moveTo(40, y);
            ctx.lineTo(280, y);
            ctx.stroke();
        }
        
        // Draw line chart
        ctx.strokeStyle = '#4299e1';
        ctx.lineWidth = 3;
        ctx.beginPath();
        data.forEach((value, index) => {
            const x = 50 + (index * 35);
            const y = 170 - (value * 1.2);
            if (index === 0) {
                ctx.moveTo(x, y);
            } else {
                ctx.lineTo(x, y);
            }
        });
        ctx.stroke();
        
        // Draw points
        data.forEach((value, index) => {
            const x = 50 + (index * 35);
            const y = 170 - (value * 1.2);
            ctx.beginPath();
            ctx.arc(x, y, 4, 0, 2 * Math.PI);
            ctx.fillStyle = '#4299e1';
            ctx.fill();
        });
        
        // Draw labels
        ctx.fillStyle = '#718096';
        ctx.font = '12px sans-serif';
        ctx.textAlign = 'center';
        labels.forEach((label, index) => {
            const x = 50 + (index * 35);
            ctx.fillText(label, x, 190);
        });
        
        logAction('å¯è¦–åŒ–', 'é€²æ—ãƒãƒ£ãƒ¼ãƒˆã‚’æç”»');
    }

    // Utility functions
    function createFloatingParticles() {
        const particlesContainer = document.getElementById('particles');
        
        for (let i = 0; i < 20; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.width = (Math.random() * 4 + 2) + 'px';
            particle.style.height = particle.style.width;
            particle.style.animationDuration = (Math.random() * 10 + 15) + 's';
            particle.style.animationDelay = Math.random() * 5 + 's';
            particlesContainer.appendChild(particle);
        }
    }

    function logAction(category, description) {
        const timestamp = new Date().toLocaleString('ja-JP');
        const logEntry = {
            timestamp: timestamp,
            category: category,
            description: description,
            sessionTime: Math.floor((Date.now() - sessionStartTime) / 1000)
        };
        
        logs.push(logEntry);
        
        // Update logs display if on logs tab
        if (currentTab === 'logs') {
            updateLogsDisplay();
        }
        
        // Save to localStorage
        localStorage.setItem('ikipLogs', JSON.stringify(logs.slice(-100))); // Keep last 100 entries
    }

    function updateLogsDisplay() {
        const logsContainer = document.getElementById('systemLogs');
        const recentLogs = logs.slice(-20).reverse(); // Show last 20 logs, newest first
        
        logsContainer.innerHTML = recentLogs.map(log => 
            `<div class="log-entry">
                <span class="log-timestamp">[${log.timestamp}]</span>
                <strong>${log.category}:</strong> ${log.description}
                <em>(ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“: ${log.sessionTime}ç§’)</em>
            </div>`
        ).join('');
    }

    function exportLogs() {
        const logData = JSON.stringify(logs, null, 2);
        const blob = new Blob([logData], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `ikip-logs-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
        logAction('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ', 'ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰');
    }

    function clearLogs() {
        if (confirm('ã™ã¹ã¦ã®ãƒ­ã‚°ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
            logs = [];
            localStorage.removeItem('ikipLogs');
            updateLogsDisplay();
            logAction('ã‚·ã‚¹ãƒ†ãƒ ', 'ãƒ­ã‚°ã‚’å…¨å‰Šé™¤');
        }
    }

    function refreshLogs() {
        updateLogsDisplay();
        logAction('ã‚·ã‚¹ãƒ†ãƒ ', 'ãƒ­ã‚°è¡¨ç¤ºã‚’æ›´æ–°');
    }

    function loadUserProgress() {
        const savedLogs = localStorage.getItem('ikipLogs');
        if (savedLogs) {
            logs = JSON.parse(savedLogs);
        }
        
        // Update session count
        userProgress.sessions++;
        logAction('ã‚»ãƒƒã‚·ãƒ§ãƒ³', `ã‚»ãƒƒã‚·ãƒ§ãƒ³ ${userProgress.sessions} é–‹å§‹`);
    }

    function saveProgress() {
        localStorage.setItem('ikipProgress', JSON.stringify(userProgress));
        logAction('ãƒ‡ãƒ¼ã‚¿', 'é€²æ—çŠ¶æ³ã‚’ä¿å­˜');
    }

    // Auto-save progress every minute
    setInterval(() => {
        userProgress.totalTime++;
        userProgress.todayTime++;
        userProgress.weeklyTime++;
        saveProgress();
        updateDashboard();
    }, 60000);

    // Initialize integration exercise on load
    setTimeout(() => {
        generateIntegrationExercise();
    }, 2000);
    </script>
</body>
</html>