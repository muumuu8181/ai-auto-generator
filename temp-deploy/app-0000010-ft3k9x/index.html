<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>インタラクティブフィットネストラッカー</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #FF6B6B;
            --secondary-color: #4ECDC4;
            --accent-color: #45B7D1;
            --success-color: #96CEB4;
            --warning-color: #FFEAA7;
            --text-dark: #2C3E50;
            --text-light: #FFFFFF;
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-dark);
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 40px;
            box-shadow: var(--card-shadow);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientMove 4s ease-in-out infinite;
        }

        .header .subtitle {
            font-size: 1.4rem;
            color: var(--text-dark);
            opacity: 0.8;
            font-weight: 600;
        }

        @keyframes gradientMove {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 30px 60px rgba(0,0,0,0.15);
        }

        .stat-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .stat-value {
            font-size: 2.8rem;
            font-weight: 900;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
            opacity: 0.8;
        }

        .workout-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: var(--card-shadow);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .section-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 30px;
            color: var(--text-dark);
            text-align: center;
        }

        .workout-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-color), #FF8E8E);
            color: var(--text-light);
        }

        .btn-success {
            background: linear-gradient(45deg, var(--success-color), #B8E6B8);
            color: var(--text-dark);
        }

        .btn-secondary {
            background: linear-gradient(45deg, var(--secondary-color), #70D7D0);
            color: var(--text-light);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .timer-display {
            text-align: center;
            margin-bottom: 30px;
            padding: 40px;
            background: linear-gradient(135deg, var(--accent-color), var(--secondary-color));
            border-radius: 25px;
            color: var(--text-light);
            box-shadow: var(--card-shadow);
        }

        .timer-time {
            font-size: 4rem;
            font-weight: 900;
            font-family: 'SF Mono', monospace;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .timer-label {
            font-size: 1.3rem;
            font-weight: 600;
            opacity: 0.9;
        }

        .progress-circle {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }

        .progress-circle svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .progress-circle circle {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
        }

        .progress-bg {
            stroke: rgba(255, 255, 255, 0.2);
        }

        .progress-fill {
            stroke: var(--warning-color);
            stroke-dasharray: 628;
            stroke-dashoffset: 628;
            transition: stroke-dashoffset 0.5s ease;
        }

        .workout-log {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: var(--card-shadow);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .exercise-list {
            display: grid;
            gap: 20px;
        }

        .exercise-item {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(78, 205, 196, 0.1));
            border-radius: 20px;
            padding: 25px;
            border-left: 5px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .exercise-item:hover {
            transform: translateX(10px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .exercise-name {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-dark);
        }

        .exercise-details {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .exercise-detail {
            background: rgba(255, 255, 255, 0.8);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-dark);
        }

        .add-exercise {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .input-group input, .input-group select {
            padding: 12px;
            border: 2px solid rgba(0,0,0,0.1);
            border-radius: 15px;
            font-size: 1rem;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.2);
        }

        .charts-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            color: var(--text-dark);
        }

        .chart {
            height: 250px;
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .achievements {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 40px;
            box-shadow: var(--card-shadow);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .achievement {
            text-align: center;
            padding: 20px;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(78, 205, 196, 0.1));
            transition: all 0.3s ease;
        }

        .achievement:hover {
            transform: scale(1.05);
        }

        .achievement.unlocked {
            background: linear-gradient(135deg, var(--success-color), #B8E6B8);
            color: var(--text-light);
        }

        .achievement-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
        }

        .achievement-name {
            font-weight: 700;
            font-size: 0.9rem;
        }

        .floating-action {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: var(--text-light);
            border: none;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .floating-action:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2.5rem;
            }

            .header .subtitle {
                font-size: 1.1rem;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
            }

            .timer-time {
                font-size: 3rem;
            }

            .charts-section {
                grid-template-columns: 1fr;
            }

            .workout-controls {
                flex-direction: column;
                align-items: center;
            }

            .add-exercise {
                grid-template-columns: 1fr;
            }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .active-workout {
            animation: pulse 2s infinite;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, var(--success-color), #B8E6B8);
            color: var(--text-dark);
            padding: 15px 25px;
            border-radius: 25px;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1001;
        }

        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>💪 フィットネストラッカー</h1>
            <div class="subtitle">あなたの健康とフィットネスの完全な記録</div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-icon">🔥</span>
                <div class="stat-value" id="caloriesBurned">0</div>
                <div class="stat-label">消費カロリー (今日)</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">⏱️</span>
                <div class="stat-value" id="workoutTime">0</div>
                <div class="stat-label">運動時間 (分)</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">🏃</span>
                <div class="stat-value" id="exerciseCount">0</div>
                <div class="stat-label">実行エクササイズ</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">🎯</span>
                <div class="stat-value" id="streak">0</div>
                <div class="stat-label">連続日数</div>
            </div>
        </div>

        <div class="workout-section">
            <h2 class="section-title">🏋️ ワークアウトタイマー</h2>
            
            <div class="timer-display">
                <div class="progress-circle">
                    <svg>
                        <circle class="progress-bg" cx="100" cy="100" r="90"></circle>
                        <circle class="progress-fill" cx="100" cy="100" r="90" id="progressCircle"></circle>
                    </svg>
                </div>
                <div class="timer-time" id="timerDisplay">00:00</div>
                <div class="timer-label" id="timerLabel">準備完了</div>
            </div>

            <div class="workout-controls">
                <button class="btn btn-primary" onclick="startWorkout()">開始</button>
                <button class="btn btn-secondary" onclick="pauseWorkout()">一時停止</button>
                <button class="btn btn-success" onclick="completeWorkout()">完了</button>
                <button class="btn" onclick="resetWorkout()">リセット</button>
            </div>
        </div>

        <div class="workout-log">
            <h2 class="section-title">📝 エクササイズログ</h2>
            
            <div class="add-exercise">
                <div class="input-group">
                    <label>エクササイズ名</label>
                    <select id="exerciseType">
                        <option value="腕立て伏せ">腕立て伏せ</option>
                        <option value="スクワット">スクワット</option>
                        <option value="腹筋">腹筋</option>
                        <option value="プランク">プランク</option>
                        <option value="ランニング">ランニング</option>
                        <option value="ウォーキング">ウォーキング</option>
                        <option value="バーピー">バーピー</option>
                        <option value="ジャンピングジャック">ジャンピングジャック</option>
                        <option value="マウンテンクライマー">マウンテンクライマー</option>
                        <option value="デッドリフト">デッドリフト</option>
                        <option value="ベンチプレス">ベンチプレス</option>
                        <option value="懸垂">懸垂</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>回数/時間</label>
                    <input type="number" id="exerciseReps" placeholder="例: 20" min="1">
                </div>
                <div class="input-group">
                    <label>セット数</label>
                    <input type="number" id="exerciseSets" placeholder="例: 3" min="1" value="1">
                </div>
                <div class="input-group">
                    <label>重量 (kg)</label>
                    <input type="number" id="exerciseWeight" placeholder="例: 60" min="0" step="0.5">
                </div>
                <div class="input-group">
                    <label style="visibility: hidden;">追加</label>
                    <button class="btn btn-primary" onclick="addExercise()">エクササイズ追加</button>
                </div>
            </div>

            <div class="exercise-list" id="exerciseList">
            </div>
        </div>

        <div class="charts-section">
            <div class="chart-container">
                <h3 class="chart-title">📊 週間運動時間</h3>
                <div class="chart" id="weeklyChart">
                    <canvas id="weeklyCanvas" width="350" height="220"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <h3 class="chart-title">🔥 カロリー消費推移</h3>
                <div class="chart" id="calorieChart">
                    <canvas id="calorieCanvas" width="350" height="220"></canvas>
                </div>
            </div>
        </div>

        <div class="achievements">
            <h2 class="section-title">🏆 達成実績</h2>
            <div class="achievements-grid" id="achievementsGrid">
                <div class="achievement" data-achievement="first-workout">
                    <span class="achievement-icon">🎯</span>
                    <div class="achievement-name">初回ワークアウト</div>
                </div>
                <div class="achievement" data-achievement="100-exercises">
                    <span class="achievement-icon">💯</span>
                    <div class="achievement-name">100エクササイズ</div>
                </div>
                <div class="achievement" data-achievement="1000-calories">
                    <span class="achievement-icon">🔥</span>
                    <div class="achievement-name">1000カロリー消費</div>
                </div>
                <div class="achievement" data-achievement="7-day-streak">
                    <span class="achievement-icon">📅</span>
                    <div class="achievement-name">7日連続</div>
                </div>
                <div class="achievement" data-achievement="30-minutes">
                    <span class="achievement-icon">⏰</span>
                    <div class="achievement-name">30分ワークアウト</div>
                </div>
                <div class="achievement" data-achievement="strong-lifter">
                    <span class="achievement-icon">💪</span>
                    <div class="achievement-name">重量挙げマスター</div>
                </div>
            </div>
        </div>
    </div>

    <button class="floating-action" onclick="quickAddExercise()" title="クイック追加">➕</button>

    <div class="notification" id="notification"></div>

    <script>
        class FitnessTracker {
            constructor() {
                this.exercises = JSON.parse(localStorage.getItem('exercises')) || [];
                this.stats = JSON.parse(localStorage.getItem('stats')) || {
                    caloriesBurned: 0,
                    workoutTime: 0,
                    exerciseCount: 0,
                    streak: 0
                };
                this.achievements = JSON.parse(localStorage.getItem('achievements')) || [];
                this.workoutTimer = {
                    startTime: null,
                    elapsedTime: 0,
                    isRunning: false,
                    interval: null
                };
                
                this.calorieData = {
                    '腕立て伏せ': 0.5,
                    'スクワット': 0.6,
                    '腹筋': 0.4,
                    'プランク': 0.3,
                    'ランニング': 10,
                    'ウォーキング': 5,
                    'バーピー': 1.2,
                    'ジャンピングジャック': 0.8,
                    'マウンテンクライマー': 0.9,
                    'デッドリフト': 0.8,
                    'ベンチプレス': 0.7,
                    '懸垂': 1.0
                };

                this.init();
            }

            init() {
                this.updateStats();
                this.renderExercises();
                this.renderAchievements();
                this.drawCharts();
                this.checkDailyGoals();
            }

            updateStats() {
                document.getElementById('caloriesBurned').textContent = Math.round(this.stats.caloriesBurned);
                document.getElementById('workoutTime').textContent = Math.round(this.stats.workoutTime);
                document.getElementById('exerciseCount').textContent = this.stats.exerciseCount;
                document.getElementById('streak').textContent = this.stats.streak;
            }

            startWorkout() {
                if (!this.workoutTimer.isRunning) {
                    this.workoutTimer.startTime = Date.now() - this.workoutTimer.elapsedTime;
                    this.workoutTimer.isRunning = true;
                    this.workoutTimer.interval = setInterval(() => this.updateTimer(), 1000);
                    
                    document.querySelector('.timer-display').classList.add('active-workout');
                    document.getElementById('timerLabel').textContent = 'ワークアウト中';
                    this.showNotification('ワークアウト開始！頑張りましょう！');
                }
            }

            pauseWorkout() {
                if (this.workoutTimer.isRunning) {
                    this.workoutTimer.isRunning = false;
                    clearInterval(this.workoutTimer.interval);
                    document.querySelector('.timer-display').classList.remove('active-workout');
                    document.getElementById('timerLabel').textContent = '一時停止中';
                }
            }

            completeWorkout() {
                if (this.workoutTimer.elapsedTime > 0) {
                    const workoutMinutes = Math.floor(this.workoutTimer.elapsedTime / 60000);
                    this.stats.workoutTime += workoutMinutes;
                    
                    this.resetWorkout();
                    this.saveData();
                    this.updateStats();
                    this.checkAchievements();
                    this.showNotification(`ワークアウト完了！${workoutMinutes}分間お疲れ様でした！`);
                }
            }

            resetWorkout() {
                this.workoutTimer.startTime = null;
                this.workoutTimer.elapsedTime = 0;
                this.workoutTimer.isRunning = false;
                clearInterval(this.workoutTimer.interval);
                
                document.querySelector('.timer-display').classList.remove('active-workout');
                document.getElementById('timerDisplay').textContent = '00:00';
                document.getElementById('timerLabel').textContent = '準備完了';
                document.getElementById('progressCircle').style.strokeDashoffset = '628';
            }

            updateTimer() {
                if (this.workoutTimer.isRunning) {
                    this.workoutTimer.elapsedTime = Date.now() - this.workoutTimer.startTime;
                    
                    const minutes = Math.floor(this.workoutTimer.elapsedTime / 60000);
                    const seconds = Math.floor((this.workoutTimer.elapsedTime % 60000) / 1000);
                    
                    document.getElementById('timerDisplay').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    // Progress circle animation (30 minute max)
                    const maxTime = 30 * 60 * 1000; // 30 minutes
                    const progress = Math.min(this.workoutTimer.elapsedTime / maxTime, 1);
                    const offset = 628 - (628 * progress);
                    document.getElementById('progressCircle').style.strokeDashoffset = offset;
                }
            }

            addExercise() {
                const type = document.getElementById('exerciseType').value;
                const reps = parseInt(document.getElementById('exerciseReps').value);
                const sets = parseInt(document.getElementById('exerciseSets').value) || 1;
                const weight = parseFloat(document.getElementById('exerciseWeight').value) || 0;

                if (!reps || reps <= 0) {
                    this.showNotification('回数/時間を正しく入力してください');
                    return;
                }

                const exercise = {
                    id: Date.now(),
                    type,
                    reps,
                    sets,
                    weight,
                    date: new Date().toISOString(),
                    calories: this.calculateCalories(type, reps, sets, weight)
                };

                this.exercises.push(exercise);
                this.stats.exerciseCount++;
                this.stats.caloriesBurned += exercise.calories;

                // Clear inputs
                document.getElementById('exerciseReps').value = '';
                document.getElementById('exerciseSets').value = '1';
                document.getElementById('exerciseWeight').value = '';

                this.saveData();
                this.updateStats();
                this.renderExercises();
                this.checkAchievements();
                this.drawCharts();
                this.showNotification(`${type} を追加しました！`);
            }

            calculateCalories(type, reps, sets, weight) {
                const baseCalories = this.calorieData[type] || 0.5;
                let totalCalories = baseCalories * reps * sets;
                
                // Weight bonus
                if (weight > 0) {
                    totalCalories += weight * 0.1 * sets;
                }
                
                return Math.round(totalCalories);
            }

            renderExercises() {
                const container = document.getElementById('exerciseList');
                
                if (this.exercises.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 40px; color: #7f8c8d; font-style: italic;">まだエクササイズが記録されていません。<br>上記のフォームから追加してください。</div>';
                    return;
                }

                const recentExercises = this.exercises.slice(-10).reverse();
                
                container.innerHTML = recentExercises.map(exercise => `
                    <div class="exercise-item">
                        <div class="exercise-name">${exercise.type}</div>
                        <div class="exercise-details">
                            <span class="exercise-detail">回数: ${exercise.reps}</span>
                            <span class="exercise-detail">セット: ${exercise.sets}</span>
                            ${exercise.weight > 0 ? `<span class="exercise-detail">重量: ${exercise.weight}kg</span>` : ''}
                            <span class="exercise-detail">🔥 ${exercise.calories}kcal</span>
                        </div>
                        <div style="font-size: 0.8rem; color: #7f8c8d; margin-top: 10px;">
                            ${new Date(exercise.date).toLocaleString('ja-JP')}
                        </div>
                    </div>
                `).join('');
            }

            checkAchievements() {
                const newAchievements = [];

                // First workout
                if (this.exercises.length >= 1 && !this.achievements.includes('first-workout')) {
                    newAchievements.push('first-workout');
                }

                // 100 exercises
                if (this.stats.exerciseCount >= 100 && !this.achievements.includes('100-exercises')) {
                    newAchievements.push('100-exercises');
                }

                // 1000 calories
                if (this.stats.caloriesBurned >= 1000 && !this.achievements.includes('1000-calories')) {
                    newAchievements.push('1000-calories');
                }

                // 30 minute workout
                if (this.stats.workoutTime >= 30 && !this.achievements.includes('30-minutes')) {
                    newAchievements.push('30-minutes');
                }

                // Strong lifter (total weight > 1000kg)
                const totalWeight = this.exercises.reduce((sum, ex) => sum + (ex.weight || 0) * ex.sets, 0);
                if (totalWeight >= 1000 && !this.achievements.includes('strong-lifter')) {
                    newAchievements.push('strong-lifter');
                }

                newAchievements.forEach(achievement => {
                    this.achievements.push(achievement);
                    this.showNotification(`🏆 新しい実績を獲得しました！`);
                });

                if (newAchievements.length > 0) {
                    this.renderAchievements();
                    this.saveData();
                }
            }

            renderAchievements() {
                const achievements = document.querySelectorAll('.achievement');
                achievements.forEach(element => {
                    const achievementId = element.dataset.achievement;
                    if (this.achievements.includes(achievementId)) {
                        element.classList.add('unlocked');
                    }
                });
            }

            drawCharts() {
                this.drawWeeklyChart();
                this.drawCalorieChart();
            }

            drawWeeklyChart() {
                const canvas = document.getElementById('weeklyCanvas');
                const ctx = canvas.getContext('2d');
                
                // Clear canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Sample data for last 7 days
                const days = ['月', '火', '水', '木', '金', '土', '日'];
                const data = this.getWeeklyData();
                
                const maxValue = Math.max(...data, 60);
                const barWidth = 40;
                const barSpacing = 10;
                const chartHeight = 180;
                
                // Draw bars
                data.forEach((value, index) => {
                    const barHeight = (value / maxValue) * chartHeight;
                    const x = 20 + index * (barWidth + barSpacing);
                    const y = canvas.height - 40 - barHeight;
                    
                    // Gradient
                    const gradient = ctx.createLinearGradient(0, y, 0, y + barHeight);
                    gradient.addColorStop(0, '#FF6B6B');
                    gradient.addColorStop(1, '#4ECDC4');
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x, y, barWidth, barHeight);
                    
                    // Day labels
                    ctx.fillStyle = '#2C3E50';
                    ctx.font = '12px SF Pro Display';
                    ctx.textAlign = 'center';
                    ctx.fillText(days[index], x + barWidth/2, canvas.height - 10);
                    
                    // Values
                    ctx.fillText(value + 'm', x + barWidth/2, y - 5);
                });
            }

            drawCalorieChart() {
                const canvas = document.getElementById('calorieCanvas');
                const ctx = canvas.getContext('2d');
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const data = this.getCalorieData();
                const maxValue = Math.max(...data, 500);
                
                // Draw line chart
                ctx.strokeStyle = '#FF6B6B';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                data.forEach((value, index) => {
                    const x = 20 + (index / (data.length - 1)) * (canvas.width - 40);
                    const y = canvas.height - 40 - (value / maxValue) * 160;
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                    
                    // Points
                    ctx.fillStyle = '#4ECDC4';
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.strokeStyle = '#FF6B6B';
                    ctx.beginPath();
                });
                
                ctx.stroke();
            }

            getWeeklyData() {
                // Sample weekly workout time data
                const today = new Date();
                const weekData = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    
                    const dayExercises = this.exercises.filter(ex => {
                        const exDate = new Date(ex.date);
                        return exDate.toDateString() === date.toDateString();
                    });
                    
                    const workoutTime = dayExercises.length * 5; // Rough estimate
                    weekData.push(Math.min(workoutTime, 120));
                }
                
                return weekData;
            }

            getCalorieData() {
                // Sample calorie data for last 7 days
                const today = new Date();
                const calorieData = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    
                    const dayExercises = this.exercises.filter(ex => {
                        const exDate = new Date(ex.date);
                        return exDate.toDateString() === date.toDateString();
                    });
                    
                    const dayCalories = dayExercises.reduce((sum, ex) => sum + ex.calories, 0);
                    calorieData.push(dayCalories);
                }
                
                return calorieData;
            }

            checkDailyGoals() {
                const today = new Date().toDateString();
                const todayExercises = this.exercises.filter(ex => 
                    new Date(ex.date).toDateString() === today
                );
                
                if (todayExercises.length > 0) {
                    this.updateStreak();
                }
            }

            updateStreak() {
                // Simple streak calculation
                const today = new Date();
                let streak = 0;
                
                for (let i = 0; i < 30; i++) {
                    const checkDate = new Date(today);
                    checkDate.setDate(checkDate.getDate() - i);
                    
                    const dayExercises = this.exercises.filter(ex => {
                        const exDate = new Date(ex.date);
                        return exDate.toDateString() === checkDate.toDateString();
                    });
                    
                    if (dayExercises.length > 0) {
                        streak++;
                    } else {
                        break;
                    }
                }
                
                this.stats.streak = streak;
            }

            quickAddExercise() {
                // Quick add most common exercise
                const quickExercises = ['腕立て伏せ', 'スクワット', '腹筋'];
                const randomExercise = quickExercises[Math.floor(Math.random() * quickExercises.length)];
                
                document.getElementById('exerciseType').value = randomExercise;
                document.getElementById('exerciseReps').value = '20';
                document.getElementById('exerciseSets').value = '1';
                
                this.showNotification(`${randomExercise} 20回がセットされました！`);
            }

            showNotification(message) {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }

            saveData() {
                localStorage.setItem('exercises', JSON.stringify(this.exercises));
                localStorage.setItem('stats', JSON.stringify(this.stats));
                localStorage.setItem('achievements', JSON.stringify(this.achievements));
            }
        }

        // Global functions
        let fitnessTracker;

        function startWorkout() {
            fitnessTracker.startWorkout();
        }

        function pauseWorkout() {
            fitnessTracker.pauseWorkout();
        }

        function completeWorkout() {
            fitnessTracker.completeWorkout();
        }

        function resetWorkout() {
            fitnessTracker.resetWorkout();
        }

        function addExercise() {
            fitnessTracker.addExercise();
        }

        function quickAddExercise() {
            fitnessTracker.quickAddExercise();
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            fitnessTracker = new FitnessTracker();
        });
    </script>
</body>
</html>